{% extends 'base.html' %}
{% load static %}

{% block content %}
<h1>{{ object.title }}</h1>
<a href="{% url 'tasks:milestone_update' object.project.id object.id%}"><i class="fa fa-pencil"></i>update</a>
<a href="{% url 'tasks:milestone_delete' object.project.id object.id%}"><i class="fa fa-trash">delete</i></a>
<p><strong>Status:</strong> {{ object.status }}</p>
<p><strong>Tasks: {{ num_completed_tasks }} completed of ({{object.tasks.count}}):</p>
<p><strong>Estimated Time Left:</strong> {{ total_left_estimated_duration }} minutes <strong> Total estimated </strong>{{total_estimated_duration}}</p>
<p><strong>Creation time:</strong> {{ f_creation_time }}</p>

  <input type="text" id="title-filter" onkeyup="filterListByTitle()" placeholder="Filter by title...">
  <button onclick="sortListByDuration()">Sort by duration</button>
  <button onclick="sortListByStatus()">Sort by status</button>

  <input type="checkbox" name="status" value="TO_DO" onclick="filterListByStatus()" checked> To do
  <input type="checkbox" name="status" value="IN_PROGRESS" onclick="filterListByStatus()"checked> In progress
  <input type="checkbox" name="status" value="CANCELLED" onclick="filterListByStatus()"> Cancelled
  <input type="checkbox" name="status" value="COMPLETED" onclick="filterListByStatus()"> Completed

  <div class="work-items-container">
    {% for task in tasks.all %}
    <div class="work-item">
      <h2 class="title"><a href="{% url 'tasks:task_detail' project_id=object.project.id milestone_id=object.id pk=task.pk %}"><i class="fa fa-trash">{{ task.title }}</i></a></h2>
      <p>Duration: <div class="duration">{{ task.estimated_duration }}</div></p>
      <p class="status">{{ task.status }}</p>
      <a href="{% url 'tasks:task_update' project_id=object.project.id milestone_id=object.id pk=task.pk %}"><i class="fa fa-trash">update</i></a> 
      <a href="{% url 'tasks:task_delete' project_id=object.project.id milestone_id=object.id pk=task.pk %}"><i class="fa fa-trash">delete</i></a> 
      </br>
    </div>

    {% empty %}
      <li>No task found.</li>
    {% endfor %}
  </div>

  <a href="{% url 'tasks:task_create' object.project.id object.id%}">Add a task</a>
  <a href="{% url 'tasks:project_detail' object.project.id%}">Return to project</a>
  
{% endblock %}
  
  
  {% block extend_footer %}
    <script src="{% static 'tasks/functions.js' %}"></script>
  {% endblock %}